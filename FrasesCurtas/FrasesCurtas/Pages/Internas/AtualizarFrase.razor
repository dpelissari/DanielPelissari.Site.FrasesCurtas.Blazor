@page "/int/frases/atualizar-frase/{id}";
@attribute [Authorize(Roles = "Administrador")]

@using FrasesCurtas.Models;
@inject NavigationManager NavigationManager;
@inject FrasesCurtas.Services.IFraseService FraseService;
@inject FrasesCurtas.Services.IAutorService AutorService;

<h3>Atualizar Frase</h3>

<EditForm Model="frase" OnValidSubmit="AtualizarFrases">
    <label for="autorFrase">Autor</label>
        <InputSelect @bind-Value="frase.IdAutor" class="form-control">
             
            @foreach (var autor in autores)
            {
                <option value="@autor.Id">@autor.Nome</option>
            }
        </InputSelect>
    <div class="form-group mb-3">
        <label for="descricaoFrase">Frase</label>
        <InputText @bind-Value="frase.Descricao" class="form-control" id="descricaoFrase"></InputText>
    </div>
    <div class="form-group mb-3">
        <label for="dataCadastroFrase">Data Cadastro</label>
             <InputDate @bind-Value="frase.DataCadastro" id="dataCadastroFrase"/>
    </div>
    <div class="form-group mb-3">
        <label for="arquivadaFrase">Arquvida</label>
           <InputSelect @bind-Value="frase.Arquivada" class="form-control">
             <option value="true">Sim</option>
             <option value="false">Não</option>
        </InputSelect>
    </div>

    <DataAnnotationsValidator />
    <ValidationSummary />

    <button class="btn btn-success" type="submit">Incluir</button>

</EditForm>

@code {
    Frase frase = new();
    private IQueryable<Autor> autores;

    [Parameter]public string id{ get; set; }  

    protected override async Task OnInitializedAsync()
    {
        frase = await FraseService.BuscarPor(Guid.Parse(id));
        autores = await AutorService.BuscarTodas();
    }
    

    async Task AtualizarFrases()
    {
        await FraseService.Atualizar(frase);

        NavigationManager.NavigateTo("/int/frases");
    }

}
